// Embedded translations
const EMBEDDED_TRANSLATIONS = {
  en: {
    "header": {
      "themeToggle": "Toggle Theme",
      "themeLabel": "Theme"
    },
    "serviceTimes": {
      "sunday": "Sunday",
      "sundayTime": "10:00 AM",
      "tuesday": "Tuesday",
      "tuesdayTime": "6:00 PM",
      "thursday": "Thursday",
      "thursdayTime": "6:00 PM",
      "saturday": "Saturday",
      "saturdayTime": "2:00 PM"
    },
    "animatedText": {
      "our": "O",
      "god": "U",
      "is": "R",
      "consuming": "G",
      "fire": "O",
      "each": "D",
      "word": "I",
      "letter": "S",
      "move": "C",
      "sequence": "O",
      "photos": "N",
      "like": "S",
      "the": "U",
      "in": "M",
      "sequence2": "I",
      "photos2": "N",
      "like2": "G",
      "the2": "F",
      "in2": "I",
      "sequence3": "R",
      "photos3": "E"
    },
    "hero": {
      "welcome": "WELCOME TO CHRIST SYNAGOGUE MINISTRIES",
      "welcomeCSM": "WELCOME TO CSM",
      "findWay": "KARIBU CSM",
      "subtitle": "Led by Prophet Baraka David Ogillo in Arusha, Tanzania—dedicated to transforming lives through guidance, deliverance, and Spirit-filled worship.",
      "visit": "VISIT US",
      "watchOnline": "WATCH ONLINE"
    },
    "photos": {
      "worship": "Worship",
      "community": "Community",
      "prayer": "Prayer",
      "outreach": "Outreach",
      "prophet": "Prophet",
      "ministry": "Ministry"
    },
    "services": {
      "sunday": "Sunday",
      "tuesday": "Tuesday", 
      "thursday": "Thursday",
      "saturday": "Saturday",
      "worship": "Worship & Prophetic Message",
      "prayer": "Prayer & Bible Study",
      "deliverance": "Deliverance & Revival",
      "special": "Special Service"
    },
    "about": {
      "title": "OUR GOD IS CONSUMING FIRE",
      "subtitle": "Christ Synagogue Ministries is a ministry in Arusha, Tanzania, led by Prophet Baraka David Ogillo. We're dedicated to transforming lives through guidance, deliverance, and Spirit-filled worship.",
      "livesChanged": "Lives Changed",
      "deliverances": "Deliverances",
      "faith": "Faith-Based",
      "joinUs": "Join Us",
      "watchSermons": "Watch Sermons"
    },
    "ministries": {
      "title": "Ministries",
      "prophetic": "Prophetic Ministry",
      "propheticDesc": "Delivering prophetic insight and divine direction through the power of the Holy Spirit.",
      "prayer": "Prayer & Deliverance", 
      "prayerDesc": "Breaking spiritual chains and promoting spiritual freedom through prayer and deliverance services.",
      "online": "Online Outreach",
      "onlineDesc": "Streaming content on YouTube, Facebook, and TikTok to reach a global audience."
    },
    "sermons": {
      "title": "Sermons",
      "browseAll": "Browse All",
      "latest": "Latest Prophetic Service",
      "deliverance": "Deliverance & Prayer Service", 
      "worship": "Spirit-Filled Worship"
    },
    "gallery": {
      "title": "Church Gallery",
      "subtitle": "Capturing moments of worship, fellowship, and ministry",
      "prophet": "Prophet Baraka David Ogillo",
      "prophetDesc": "Founder and leader of Christ Synagogue Ministries",
      "propheticMinistry": "Prophetic Ministry",
      "propheticMinistryDesc": "Divine direction and spiritual breakthrough",
      "sundayWorship": "Sunday Worship",
      "sundayWorshipDesc": "Spirit-filled worship and praise",
      "prayerMinistry": "Prayer Ministry", 
      "prayerMinistryDesc": "Breaking spiritual chains",
      "fellowship": "Fellowship",
      "fellowshipDesc": "Community and spiritual growth",
      "ministryEvent": "Ministry Event",
      "ministryEventDesc": "Spreading the gospel message",
      "churchService": "Church Service",
      "churchServiceDesc": "Gathering in worship and fellowship",
      "ministryPrayer": "Ministry Prayer",
      "ministryPrayerDesc": "Seeking God's guidance and blessing",
      "communityGathering": "Community Gathering",
      "communityGatheringDesc": "Building strong relationships in Christ",
      "worshipPraise": "Worship & Praise",
      "worshipPraiseDesc": "Lifting voices in joyful worship",
      "ministryOutreach": "Ministry Outreach",
      "ministryOutreachDesc": "Reaching out to the community"
    },
    "testimonies": {
      "title": "Ministry Testimonies",
      "subtitle": "Hear how God is transforming lives through our ministry",
      "deliverance": "Deliverance Testimony",
      "deliveranceDesc": "Sarah shares how prayer and deliverance broke spiritual chains in her life.",
      "prophetic": "Prophetic Direction", 
      "propheticDesc": "John testifies about receiving divine direction that changed his career path.",
      "healing": "Healing Testimony",
      "healingDesc": "Mary experienced miraculous healing during a prayer service.",
      "memberSince": "Member since"
    },
    "prayer": {
      "title": "Book Prayer Session",
      "subtitle": "Schedule a personal prayer session with Prophet Baraka David Ogillo",
      "fullName": "Full Name",
      "phone": "Phone Number", 
      "date": "Preferred Date",
      "time": "Preferred Time",
      "selectTime": "Select Time",
      "request": "Prayer Request",
      "placeholder": "Share your prayer needs...",
      "book": "Book Prayer Session",
      "details": "Prayer Session Details",
      "session30": "30-minute personal prayer session",
      "guidance": "Prophetic guidance and direction",
      "deliverancePrayer": "Deliverance prayer if needed",
      "available": "Available Monday-Friday",
      "whatsapp": "Contact via WhatsApp"
    },
    "events": {
      "title": "Upcoming Events",
      "viewCalendar": "View Calendar",
      "conference": "Prophetic Conference",
      "upcoming": "Upcoming Event",
      "conferenceDesc": "Join us for a powerful prophetic conference featuring divine direction and spiritual breakthrough.",
      "register": "Register",
      "crusade": "Deliverance Crusade",
      "monthly": "Monthly Event", 
      "crusadeDesc": "Experience freedom from spiritual bondage through prayer, deliverance, and anointing services.",
      "attend": "Attend"
    },
    "give": {
      "title": "Support the Ministry",
      "description": "Your generous support enables us to continue spreading messages, deliverance services, and reaching souls globally through our online platforms.",
      "mpesaTitle": "M-Pesa Payment",
      "mpesaDesc": "Send your support via M-Pesa",
      "crdbTitle": "CRDB Bank Transfer",
      "crdbDesc": "Bank transfer to our ministry account",
      "phoneNumber": "Phone Number:",
      "accountNumber": "Account Number:",
      "accountName": "Account Name:",
      "copy": "Copy"
    },
    "visit": {
      "title": "Visit Us",
      "subtitle": "Find us in Majengo, Arusha, Tanzania",
      "getDirections": "Get Directions",
      "shareLocation": "Share Location",
      "location": "Location",
      "openMaps": "Open in Maps",
      "contactUs": "Contact Us",
      "sendMessage": "Send Message",
      "prophet": "Prophet Baraka David Ogillo",
      "prophetDesc": "Founder and leader of Christ Synagogue Ministries, author of books and magazines.",
      "learnMore": "Learn More"
    },
    "contact": {
      "title": "Contact Us",
      "description": "We would love to hear from you. Send a message and our ministry team will follow up.",
      "name": "Name",
      "email": "Email",
      "message": "Message",
      "sendMessage": "Send Message"
    },
    "footer": {
      "copyright": "Christ Synagogue Ministries. All rights reserved."
    },
    "pwa": {
      "install": "Install Christ Synagogue Ministries App",
      "description": "Get quick access to sermons, events, and prayer requests",
      "installBtn": "Install",
      "offline": "You're offline. Some features may not be available."
    }
  },
  sw: {
    "header": {
      "themeToggle": "Badilisha Muundo",
      "themeLabel": "Muundo"
    },
    "serviceTimes": {
      "sunday": "Jumapili",
      "sundayTime": "10:00 AM",
      "tuesday": "Jumanne",
      "tuesdayTime": "6:00 PM",
      "thursday": "Alhamisi",
      "thursdayTime": "6:00 PM",
      "saturday": "Jumamosi",
      "saturdayTime": "2:00 PM"
    },
    "animatedText": {
      "our": "O",
      "god": "U",
      "is": "R",
      "consuming": "G",
      "fire": "O",
      "each": "D",
      "word": "I",
      "letter": "S",
      "move": "C",
      "sequence": "O",
      "photos": "N",
      "like": "S",
      "the": "U",
      "in": "M",
      "sequence2": "I",
      "photos2": "N",
      "like2": "G",
      "the2": "F",
      "in2": "I",
      "sequence3": "R",
      "photos3": "E"
    },
    "hero": {
      "welcome": "KARIBU CHRIST SYNAGOGUE MINISTRIES",
      "welcomeCSM": "KARIBU CSM",
      "findWay": "KARIBU CSM",
      "subtitle": "Inaongozwa na Nabii Baraka David Ogillo huko Arusha, Tanzania—inayojitolea kubadilisha maisha kupitia uongozi, ukombozi, na ibada iliyojaa Roho.",
      "visit": "TEMBELEA",
      "watchOnline": "ANGALIA MTANDAONI"
    },
    "photos": {
      "worship": "Ibada",
      "community": "Jumuiya",
      "prayer": "Maombi",
      "outreach": "Uenezi",
      "prophet": "Nabii",
      "ministry": "Huduma"
    },
    "services": {
      "sunday": "Jumapili",
      "tuesday": "Jumanne", 
      "thursday": "Alhamisi",
      "saturday": "Jumamosi",
      "worship": "Ibada na Ujumbe wa Unabii",
      "prayer": "Sala na Uchunguzi wa Biblia",
      "deliverance": "Ukombozi na Uamsho",
      "special": "Huduma ya Kipekee"
    },
    "about": {
      "title": "MUNGU WETU NI MOTO ULAO",
      "subtitle": "Christ Synagogue Ministries ni huduma iliyoko Arusha, Tanzania, inayoongozwa na Nabii Baraka David Ogillo. Tunajitolea kubadilisha maisha kupitia uongozi, ukombozi, na ibada iliyojaa Roho.",
      "livesChanged": "Maisha Yamebadilishwa",
      "deliverances": "Ukombozi",
      "faith": "Imani-Based",
      "joinUs": "Jiunge Nasi",
      "watchSermons": "Tazama Mahubiri"
    },
    "ministries": {
      "title": "Huduma",
      "prophetic": "Huduma ya Unabii",
      "propheticDesc": "Kutoa ufahamu wa unabii na uongozi wa kimungu kupitia nguvu ya Roho Mtakatifu.",
      "prayer": "Sala na Ukombozi", 
      "prayerDesc": "Kuvunja minyororo ya kiroho na kukuza uhuru wa kiroho kupitia huduma za sala na ukombozi.",
      "online": "Ufikiaji wa Mtandaoni",
      "onlineDesc": "Kutangaza maudhui kwenye YouTube, Facebook, na TikTok ili kufikia hadhira ya kimataifa."
    },
    "sermons": {
      "title": "Mahubiri",
      "browseAll": "Tazama Yote",
      "latest": "Huduma ya Unabii ya Hivi Karibuni",
      "deliverance": "Huduma ya Ukombozi na Sala", 
      "worship": "Ibada Iliyojaa Roho"
    },
    "gallery": {
      "title": "Picha za Kanisa",
      "subtitle": "Kukumbuka nyakati za ibada, ushirika, na huduma",
      "prophet": "Nabii Baraka David Ogillo",
      "prophetDesc": "Mwanzilishi na kiongozi wa Christ Synagogue Ministries",
      "propheticMinistry": "Huduma ya Unabii",
      "propheticMinistryDesc": "Uongozi wa kimungu na uvumbuzi wa kiroho",
      "sundayWorship": "Ibada ya Jumapili",
      "sundayWorshipDesc": "Ibada iliyojaa Roho na sifa",
      "prayerMinistry": "Huduma ya Sala", 
      "prayerMinistryDesc": "Kuvunja minyororo ya kiroho",
      "fellowship": "Ushirika",
      "fellowshipDesc": "Jumuiya na ukuaji wa kiroho",
      "ministryEvent": "Tukio la Huduma",
      "ministryEventDesc": "Kusambaza ujumbe wa injili",
      "churchService": "Huduma ya Kanisa",
      "churchServiceDesc": "Kukusanyika kwa ibada na ushirika",
      "ministryPrayer": "Sala ya Huduma",
      "ministryPrayerDesc": "Kutafuta uongozi na baraka za Mungu",
      "communityGathering": "Mkutano wa Jumuiya",
      "communityGatheringDesc": "Kujenga mahusiano mazuri katika Kristo",
      "worshipPraise": "Ibada na Sifa",
      "worshipPraiseDesc": "Kuinua sauti katika ibada ya furaha",
      "ministryOutreach": "Kufikia Jumuiya",
      "ministryOutreachDesc": "Kufikia jumuiya na huduma"
    },
    "testimonies": {
      "title": "Ushuhuda wa Huduma",
      "subtitle": "Sikia jinsi Mungu anavyobadilisha maisha kupitia huduma yetu",
      "deliverance": "Ushuhuda wa Ukombozi",
      "deliveranceDesc": "Sarah anashiriki jinsi sala na ukombozi vilivyovunja minyororo ya kiroho katika maisha yake.",
      "prophetic": "Uongozi wa Unabii", 
      "propheticDesc": "John anashuhudia juu ya kupokea uongozi wa kimungu uliobadilisha njia ya kazi yake.",
      "healing": "Ushuhuda wa Uponyaji",
      "healingDesc": "Mary alipata uponyaji wa miujiza wakati wa huduma ya sala.",
      "memberSince": "Mwanachama tangu"
    },
    "prayer": {
      "title": "Panga Kipindi cha Sala",
      "subtitle": "Panga kipindi cha sala binafsi na Nabii Baraka David Ogillo",
      "fullName": "Jina Kamili",
      "phone": "Nambari ya Simu", 
      "date": "Tarehe ya Kupendelea",
      "time": "Muda wa Kupendelea",
      "selectTime": "Chagua Muda",
      "request": "Ombi la Sala",
      "placeholder": "Shiriki mahitaji yako ya sala...",
      "book": "Panga Kipindi cha Sala",
      "details": "Maelezo ya Kipindi cha Sala",
      "session30": "Kipindi cha sala binafsi cha dakika 30",
      "guidance": "Uongozi wa unabii na mwelekezo",
      "deliverancePrayer": "Sala ya ukombozi ikiwa inahitajika",
      "available": "Inapatikana Jumatatu-Ijumaa",
      "whatsapp": "Wasiliana kupitia WhatsApp"
    },
    "events": {
      "title": "Matukio Yanayokuja",
      "viewCalendar": "Tazama Kalenda",
      "conference": "Mkutano wa Unabii",
      "upcoming": "Tukio la Hivi Karibuni",
      "conferenceDesc": "Jiunge nasi kwa mkutano wa unabii wenye nguvu unaojumuisha uongozi wa kimungu na uvumbuzi wa kiroho.",
      "register": "Jisajili",
      "crusade": "Msafara wa Ukombozi",
      "monthly": "Tukio la Kila Mwezi", 
      "crusadeDesc": "Jifunze uhuru kutoka kwa utumwa wa kiroho kupitia huduma za sala, ukombozi, na kupaka mafuta.",
      "attend": "Hudhuria"
    },
    "give": {
      "title": "Tegemeza Huduma",
      "description": "Msaada wako wa ukarimu unaturuhusu kuendelea kusambaza ujumbe, huduma za ukombozi, na kufikia roho duniani kote kupitia mifumo yetu ya mtandaoni.",
      "mpesaTitle": "Malipo ya M-Pesa",
      "mpesaDesc": "Tuma msaada wako kupitia M-Pesa",
      "crdbTitle": "Uhamisho wa Benki ya CRDB",
      "crdbDesc": "Uhamisho wa benki kwenye akaunti yetu ya huduma",
      "phoneNumber": "Nambari ya Simu:",
      "accountNumber": "Nambari ya Akaunti:",
      "accountName": "Jina la Akaunti:",
      "copy": "Nakili"
    },
    "visit": {
      "title": "Tutembelee",
      "subtitle": "Tutafute huko Majengo, Arusha, Tanzania",
      "getDirections": "Pata Maelekezo",
      "shareLocation": "Shiriki Mahali",
      "location": "Mahali",
      "openMaps": "Fungua katika Ramani",
      "contactUs": "Wasiliana Nasi",
      "sendMessage": "Tuma Ujumbe",
      "prophet": "Nabii Baraka David Ogillo",
      "prophetDesc": "Mwanzilishi na kiongozi wa Christ Synagogue Ministries, mwandishi wa vitabu na magazeti.",
      "learnMore": "Jifunze Zaidi"
    },
    "contact": {
      "title": "Wasiliana Nasi",
      "description": "Tungependa kusikia kutoka kwako. Tuma ujumbe na timu yetu ya huduma itafuatilia.",
      "name": "Jina",
      "email": "Barua Pepe",
      "message": "Ujumbe",
      "sendMessage": "Tuma Ujumbe"
    },
    "footer": {
      "copyright": "Christ Synagogue Ministries. Haki zote zimehifadhiwa."
    },
    "pwa": {
      "install": "Sakinisha Programu ya Christ Synagogue Ministries",
      "description": "Pata ufikiaji wa haraka wa mahubiri, matukio, na maombi ya sala",
      "installBtn": "Sakinisha",
      "offline": "Hauko mtandaoni. Baadhi ya vipengele vinaweza kutokuwa vinapatikana."
    }
  }
};

// Translation System for Christ Synagogue Ministries
class TranslationSystem {
  constructor() {
    this.currentLang = localStorage.getItem('language') || 'en';
    this.translations = EMBEDDED_TRANSLATIONS;
    this.init();
  }

  init() {
    console.log('Initializing translation system with embedded translations...');
    console.log('Current language:', this.currentLang);
    console.log('Available translations:', Object.keys(this.translations));
    
    // Apply current language
    this.applyLanguage(this.currentLang);
    
    // Setup language toggle
    this.setupLanguageToggle();
  }

  setupLanguageToggle() {
    const langToggle = document.querySelector('.lang-toggle');
    const langText = document.querySelector('.lang-text');
    
    console.log('Setting up language toggle:', { langToggle, langText });
    
    if (langToggle && langText) {
      // Update button text
      langText.textContent = this.currentLang === 'en' ? 'SW' : 'EN';
      
      // Add click handler
      langToggle.addEventListener('click', () => {
        const newLang = this.currentLang === 'en' ? 'sw' : 'en';
        console.log('Language toggle clicked, switching to:', newLang);
        this.switchLanguage(newLang);
      });
      
      console.log('Language toggle setup complete');
    } else {
      console.error('Language toggle elements not found:', { langToggle, langText });
    }
  }

  switchLanguage(newLang) {
    this.currentLang = newLang;
    localStorage.setItem('language', newLang);
    
    // Update button text
    const langText = document.querySelector('.lang-text');
    if (langText) {
      langText.textContent = newLang === 'en' ? 'SW' : 'EN';
    }
    
    // Apply new language
    this.applyLanguage(newLang);
    
    // Update page title
    this.updatePageTitle(newLang);
    
    console.log(`Language switched to: ${newLang}`);
  }

  applyLanguage(lang) {
    console.log('Applying language:', lang, 'Translations available:', this.translations);
    
    if (!this.translations[lang]) {
      console.error('No translations found for language:', lang);
      return;
    }
    
    // Update all elements with data-translate attribute
    const elements = document.querySelectorAll('[data-translate]');
    console.log('Found elements with data-translate:', elements.length);
    
    elements.forEach(element => {
      const key = element.getAttribute('data-translate');
      const translation = this.getTranslation(key, lang);
      
      if (translation) {
        if (element.tagName === 'INPUT' && element.type === 'text') {
          element.placeholder = translation;
        } else if (element.tagName === 'TEXTAREA') {
          element.placeholder = translation;
        } else {
          element.textContent = translation;
        }
        console.log(`Translated ${key}: ${translation}`);
      } else {
        console.warn(`No translation found for key: ${key}`);
      }
    });
    
    // Update elements with data-en/data-sw attributes
    const dataElements = document.querySelectorAll('[data-en], [data-sw]');
    console.log('Found elements with data-en/data-sw:', dataElements.length);
    
    dataElements.forEach(element => {
      const translation = element.getAttribute(`data-${lang}`);
      if (translation) {
        element.textContent = translation;
        console.log(`Updated element with data-${lang}: ${translation}`);
      }
    });
    
    // Update placeholder attributes
    const placeholderElements = document.querySelectorAll('[data-en-placeholder], [data-sw-placeholder]');
    placeholderElements.forEach(element => {
      const placeholder = element.getAttribute(`data-${lang}-placeholder`);
      if (placeholder) {
        element.placeholder = placeholder;
      }
    });
    
    // Update HTML lang attribute
    document.documentElement.setAttribute('lang', lang);
    console.log('Language application complete');
  }

  getTranslation(key, lang = this.currentLang) {
    const keys = key.split('.');
    let translation = this.translations[lang];
    
    for (const k of keys) {
      if (translation && translation[k]) {
        translation = translation[k];
      } else {
        return null;
      }
    }
    
    return translation;
  }

  updatePageTitle(lang) {
    const title = lang === 'sw' 
      ? 'Christ Synagogue Ministries - Huduma ya Unabii'
      : 'Christ Synagogue Ministries';
    document.title = title;
    
    // Update meta description
    const metaDescription = document.querySelector('meta[name="description"]');
    if (metaDescription) {
      const description = lang === 'sw' 
        ? 'Kanisa la kukaribisha linalozingatia Yesu. Jiunge nasi kwa ibada, jumuiya, na huduma.'
        : 'A welcoming church family centered on Jesus. Join us for worship, community, and service.';
      metaDescription.setAttribute('content', description);
    }
  }

  // Helper method to translate text programmatically
  t(key) {
    return this.getTranslation(key) || key;
  }
}

// Initialize translation system
function initTranslationSystem() {
  console.log('Initializing translation system...');
  window.translator = new TranslationSystem();
  console.log('Translation system initialized:', window.translator);
}

// Try multiple initialization methods to ensure it works
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initTranslationSystem);
} else {
  initTranslationSystem();
}

// Fallback initialization after a short delay
setTimeout(() => {
  if (!window.translator) {
    console.log('Fallback initialization...');
    initTranslationSystem();
  }
}, 100);

